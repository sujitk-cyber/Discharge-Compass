# AGENTS.md

## Cursor Cloud specific instructions

### Overview

Discharge Compass is a FastAPI backend + Next.js frontend app for predicting 30-day hospital readmission risk. No external databases or services are required â€” SQLite and synthetic data are embedded.

### Running services

- **Backend** (port 8000): `cd /workspace && ARTIFACT_DIR=backend/artifacts .venv/bin/uvicorn backend.src.main:app --host 0.0.0.0 --port 8000`
- **Frontend** (port 3000): `cd /workspace/frontend && NEXT_PUBLIC_API_URL=http://localhost:8000 npm run dev`
- Standard commands are in the `Makefile` and `README.md`.

### Important caveats

- **Model artifacts must exist** before the backend API works. Run `make train` (or the two training/evaluate commands in the Makefile) to generate them in `backend/artifacts/`. Without artifacts, all ML endpoints return 503.
- `python3.12-venv` system package is required to create the venv (`sudo apt-get install -y python3.12-venv`).
- Frontend ESLint requires `eslint@8` and `eslint-config-next@14.1.0` (matching the Next.js 14 version); ESLint v9 is incompatible. The `.eslintrc.json` file with `{"extends": "next/core-web-vitals"}` must exist for `npm run lint` to run non-interactively.
- Frontend metrics page reads from `frontend/public/metrics.json`, generated by the evaluate step of training.

### Pre-existing test issues

- **Backend**: Several tests fail due to `np.int64` not being JSON-serializable in the test fixture (`create_dummy_artifacts`), and `test_train_and_evaluate` fails with a StratifiedKFold split error on tiny synthetic data. These are pre-existing.
- **Frontend**: `vitest` tests fail because `vitest.config.ts` is missing `globals: true`, causing `@testing-library/jest-dom` to error on `expect.extend()`. Pre-existing.

### Lint

- Backend: no configured linter (no flake8/ruff config).
- Frontend: `cd frontend && npm run lint` (requires eslint@8 + eslint-config-next@14.1.0 installed).

### Tests

- Backend: `.venv/bin/python -m pytest backend/tests`
- Frontend: `cd frontend && npm run test`
